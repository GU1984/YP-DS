# Телеком

## Цель:

Построить модель прогнозирования отттока клинетов.

## Описание:
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

Оператор предоставляет два основных типа услуг:
1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

Также доступны такие услуги:
- Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
- Выделенная линия технической поддержки (TechSupport);
- Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
- Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).
- За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года.
- Доступны различные способы расчёта и возможность получения электронного чека.

Информация о договорах актуальна на 1 февраля 2020.

## Выводы:

1. Подготовка данных для модели:
- Выделен целевого признак - расторгнут договор или нет. В качетве базы был взят признак 'end_time',
- Был создан новые признак - действие договра в днях,
- Неинформативные признаки (идентификатор пользователя и даты) и колиниарный признак total_charged удалены,
- Данные были разделены на обучающую и тестовую 75:25.
2. Были построены и обучены модели с соотвествующими результатами:
- Модель Линейной регресии: AUC-ROC = 0,75;
- Модель Случайного Леса: AUC-ROC = 0,82;
- Модель CatBoost: AUC-ROC = 0,86;
- Модель LGBM: AUC-ROC = 0,87;
3. Выводы по полученным результатам
- Наилучший результат показала модель LGBM, именно эту модель проверили на тестовой выборке.
4. Проверка лучшей модели на тестовой выборке
- Была проверена модель LGBM со следующимим параметрами 
   * learning_rate=0.7,
   * n_estimators=200,
   * num_leaves=95.
- На тестовой выборке метрика  AUC-ROC = 0,89.
5. Анализ лучшей модели (важность признаков, матрица ошибок)
- Влияние признаков:
 - Наиболее важными признаками оказались:
    * месячный платеж,
    * длительность пользования услугами в днях.
 - Влияние остальных параметров на порядок меньше.
- Составлена матрица ошибок: 
    * модель хорошо определяет отрицательный класс (не уйдет),
    * положительный класс (уйдет) опредляет хуже.
    
    
    

